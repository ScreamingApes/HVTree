<!DOCTYPE html>
<html>

<head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">

    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://d3js.org/d3-array.v2.min.js"></script>
    <script src="js/hv_tree.js"></script>
    <script src="js/utils/tree.js"></script>
    <script src="js/algorithms/right_heavy.js"></script>
    <script src="js/algorithms/alternated_heavy.js"></script>
    <script src="js/algorithms/random_heavy.js"></script>
    <script src="js/algorithms/completely_random.js"></script>
    <script src="js/algorithms/area_heuristic.js"></script>
    <script src="js/algorithms/ratio_heuristic.js"></script>
    <script src="js/algorithms/labeled_ratio_heuristic.js"></script>

    <script src="complete_tree/complete_tree.js"></script>

    <link rel="stylesheet" type="text/css" href="css/main.css">

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
        integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
        integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

</head>

<body>
    <nav class="navbar navbar-expand-md navbar-dark bg-dark">
        <div class="navbar-collapse collapse w-100 order-1 order-md-0 dual-collapse2">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item">
                    <div class="container align-middle">
                        <div class="row">
                            <span id="tree_name" class="text-info">Tree</span>
                            <span id="algorithm_name" class="text-light ml-4">Algorithm</span>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
        <div class="mx-auto order-0 align-middle">
            <a class="navbar-brand mx-auto" href="#">HV Trees</a>
        </div>
        <div class="navbar-collapse collapse w-100 order-3 dual-collapse2">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <div class="container">
                        <div class="row">
                            <span class="dropdown align-middle">
                                <a class="nav-link dropdown-toggle pointer" id="navbarDropdownMenuLink"
                                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> Select
                                    Algorithm</a>
                                <ul class="dropdown-menu dropdown-menu-right">
                                    <button class="dropdown-item" type="button"
                                        onClick="change_algorithm('right_heavy')">Right
                                        Heavy</button>
                                    <button class="dropdown-item" type="button"
                                        onClick="change_algorithm('alternated_heavy')">Alternate Heavy</button>
                                    <button class="dropdown-item" type="button"
                                        onClick="change_algorithm('completely_random')">Completely Random</button>
                                    <button class="dropdown-item" type="button"
                                        onClick="change_algorithm('random_heavy')">Random
                                        Heavy</button>
                                    <button class="dropdown-item" type="button"
                                        onClick="change_algorithm('area_heuristic')">Area Heuristic</button>
                                    <button class="dropdown-item" type="button"
                                        onClick="change_algorithm('ratio_heuristic')">Ratio Heuristic</button>
                                    <button class="dropdown-item" type="button"
                                        onClick="change_algorithm('labeled_ratio_heuristic')">Labeled Ratio
                                        Heuristic</button>
                                </ul>
                            </span>
                            <span class="dropdown align-middle">
                                <a class="nav-link dropdown-toggle pointer" id="navbarDropdownMenuLink"
                                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> Select Tree</a>
                                <ul class="dropdown-menu dropdown-menu-right">
                                    <li>
                                        <button type="button" class="dropdown-item btn btn-primary" data-toggle="modal"
                                            data-target="#completeTreeModal">
                                            Create Complete Tree
                                        </button>
                                    </li>

                                    <button class="dropdown-item" type="button" onClick="change_filename('tree9')">Tree
                                        9</button>
                                    <button class="dropdown-item" type="button" onClick="change_filename('tree13')">Tree
                                        13</button>
                                    <button class="dropdown-item" type="button" onClick="change_filename('tree30')">Tree
                                        30</button>
                                    <button class="dropdown-item" type="button"
                                        onClick="change_filename('tree100')">Tree
                                        100</button>
                                    <button class="dropdown-item" type="button"
                                        onClick="change_filename('tree250')">Tree
                                        250</button>
                                    <button class="dropdown-item" type="button"
                                        onClick="change_filename('tree500')">Tree
                                        500</button>
                                    <button class="dropdown-item" type="button"
                                        onClick="change_filename('tree750')">Tree
                                        750</button>
                                    <button class="dropdown-item" type="button"
                                        onClick="change_filename('tree1000')">Tree
                                        1000</button>
                                    <div class="dropdown-item">
                                        <input type="file" id="selectedFile" class="upload" accept=".json"
                                            onchange="change_json()" style="display: none;">
                                        <input class="btn btn-primary" type="button" value="Upload Tree"
                                            onclick="document.getElementById('selectedFile').click();" />
                                    </div>
                                </ul>
                            </span>
                            <span class="btn btn-default">
                                <a class="fa fa-info-circle fa-lg" id="icona" aria-hidden="true" data-toggle="modal"
                                    data-target="#infoModal"></a>
                            </span>
                            <span class="btn btn-default">
                                <a class="fa fa-copyright fa-lg" id="icona" aria-hidden="true" data-toggle="modal"
                                    data-target="#creditsModal"></a>
                            </span>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
    </nav>

    <div>
        <svg id="canvas"></svg>

        <div id="slider" class="card invisible"
            style="z-index: 2001; position: absolute; bottom: 0px; right: 0px; margin: 20px;">
            <div class="m-2 d-flex justify-content-center" style="align-items: center;">
                <button class="btn" onclick="change_algorithm(actual_algorithm)"><i class="fa fa-refresh"></i></button>
                <input type="range" class="custom-range" id="customRange11" min="0" max="100"
                    onchange="change_treshold(this.value / 100)">
                <span class="font-weight-bold text-primary ml-3 valueSpan2" style="width: 2em;"></span>
            </div>
        </div>

        <div class="card" style="z-index: 2001; position: absolute; bottom: 0px; left: 0px; margin: 20px;">
            <div class="m-2 d-flex justify-content-center" style="align-items: center;">
                <button class="btn" id="zoom_in"><i class="fa fa-search-plus"></i></button>
                <button class="btn" id="zoom_out"><i class="fa fa-search-minus"></i></button>
                <button class="btn" id="zoom_reset"><i class="fa fa-undo"></i></button>
            </div>
        </div>
    </div>

    <!-- COMPLETE TREES -->
    <div class="modal" id="completeTreeModal">
        <div class="modal-dialog">
            <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">Create Complete Tree</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>

                <!-- Modal body -->
                <div class="modal-body">
                    <div class="container">
                        <div class="row">
                            <div class="col-xs-6">
                                <p>Choose the depth of the tree to create:</p>
                            </div>
                            &nbsp;
                            <div class="col-xs-6">
                                <input class="border-0" type="number" min="1" max="100" value="0"
                                    onchange="change_depth(this.value)" />
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modal footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal"
                        onclick="create_complete_tree()">Submit</button>
                    <button type="button" class="btn btn-danger" data-dismiss="modal"
                        onclick="restore_tree_name()">Cancel</button>
                </div>

            </div>
        </div>
    </div>

    <!-- INFO -->
    <div class="modal" id="infoModal">
        <div class="modal-dialog">
            <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header text-center">
                    <h3 class="modal-title w-100">Algorithms</h3>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>

                <!-- Modal body -->
                <div class="modal-body">
                    <div class="container">
                        <div class="row">
                            <div class="form-group col-12">
                                <h4>Right Heavy</h2>
                                    It performs only horizontal combinations, placing the largest subtree to the right
                                    of the smallest subtree, filling an O(n log(n)) area.
                                    <hr>
                                <h4>Alternated Heavy</h3>
                                    It performs both horizontal and vertical combinations, placing the largest
                                    subtree to the right at even depth or to the bottom at odd depth, respectively.
                                    The resulting drawing occupies an O(n) area.
                                <hr>
                                <h4>Random Heavy</h3>
                                    It performs both horizontal and vertical combinations, placing the largest
                                    subtree to the bottom of the smallest subtree, with a probability setted by
                                    the user.
                                <hr>
                                <h4>Area Heuristic</h3>
                                    It places the subtrees in such a way that the occupied area is smaller.
                                <hr>
                                <h4>Ratio Heuristic</h3>
                                    It places the subtrees in such a way that the ratio of the resulting
                                    drawing is about 1.
                                <hr>
                                <h4>Labeled Ratio Heuristic</h3>
                                    Same of Ratio Heuristic, but each node has a width and height
                                    setted by the user.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modal footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
                </div>

            </div>
        </div>
    </div>

    <!-- Credits -->
    <div class="modal" id="creditsModal">
        <div class="modal-dialog">
            <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header text-center">
                    <h3 class="modal-title w-100">Credits</h3>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>

                <!-- Modal body -->
                <div class="modal-body">
                    <div class="container">
                        <div class="row">
                            <div class="form-group col-12">
                                All credits to <a href="https://github.com/gmgigi96" target="_blank">Gianmaria Del
                                    Monte</a> and <a href="https://github.com/ramorimo" target="_blank">Omar
                                    Elsayed</a>, 2020.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modal footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
                </div>

            </div>
        </div>
    </div>

    <script>
        $(document).ready(function () {
            init()
            let zoom_duration = 250

            let zoom = d3.zoom().on("zoom", zoomed);

            let svg = d3.select("svg")
                .call(zoom)
                .on("dblclick.zoom", null);
            let g = svg.select("g");

            d3.select("#zoom_in").on("click", function () {
                zoom.scaleBy(svg.transition().duration(zoom_duration), 1.2);
            });
            d3.select("#zoom_out").on("click", function () {
                zoom.scaleBy(svg.transition().duration(zoom_duration), 0.8);
            });
            d3.select("#zoom_reset").on("click", function () {
                svg.transition().duration(zoom_duration).call(zoom.transform, d3.zoomIdentity);
            });

            function zoomed() {
                g.attr("transform", d3.event.transform);
            }
        });
    </script>
</body>

</html>